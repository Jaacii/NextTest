<!doctype html>
<html>
    <head>
	<title>nexttest</title>
	<link rel="stylesheet" type="text/css" href=stylesheet.css>
	<meta charset= "utf-8">
	
	<!-- Evtl ist die doppelte resonance implimierung unnötig -->
	 
	      <script src="https://cdn.jsdelivr.net/npm/resonance-audio/build/resonance-audio.min.js"></script>

    <script>
		if (window.AudioPlayer === undefined) {
		setStatus("Sorry, your web browser cannot run this demo")
		return
}
		
		
		
		var audioPlayer = new AudioPlayer();

		
		audioPlayer.onloadcomplete = function() {
		window.console.debug("Loaded.")
		
		audioPlayer.onloadstart = null
		audioPlayer.onloaderror = null
		audioPlayer.onloadcomplete = null
		
		start()
	}

		
		
		
		
		
		if (window.AudioPlayer !== undefined) {
			audioPlayer = new AudioPlayer()
		}

		var m_context = new AudioContext()
		var m_gain = m_context.createGain()

		m_gain.connect(m_context.destination)
		m_context.listener.setOrientation(0, 0, -1, 0, 1, 0)
		
	/*	audioPlayer.onloadstart = function() { ... }
		audioPlayer.onloaderror = function() { ... }
		audioPlayer.onloadcomplete = function() { ... }*/
 
		audioPlayer.load("Cat.wav")
		audioPlayer.load("bird.wav")
		audioPlayer.load("wind.wav")


		// simplified example
 
m_loader = new XMLHttpRequest()
m_queue = []
 
function load() {
    m_loader.open("GET", m_queue[0])
    m_loader.responseType = "arraybuffer"
    m_loader.onload = onLoad
    m_loader.send()
}
 
function onLoad(event) {
    var data = m_loader.response
    var status = m_loader.status
 
    m_loader.abort() // resets the loader
 
    if (status < 400) {
        m_context.decodeAudioData(data, onDecode)
    }
}

	sound.source = m_context.createBufferSource()
sound.panner = m_context.createPanner()
 
sound.source.buffer = sound.buffer
sound.source.loop = loop
sound.source.onended = onSoundEnded
 
// This is a bit of a hack but we need to reference the sound
// object in the onSoundEnded event handler, and doing things
// this way is more optimal than binding the handler.
sound.source.sound = sound
             
sound.panner.panningModel = "HRTF"
sound.panner.distanceModel = "linear"
sound.panner.setPosition(sound.x, sound.y, sound.z)
 
sound.source.connect(sound.panner)
sound.panner.connect(m_gain)
 
sound.source.start()




	var sound1 = audioPlayer.create("Cat.wav")
	var sound2 = audioPlayer.create("bird.wav")
	var sound3 = audioPlayer.create("wind.wav")

//////




		//Später Script in einzelne Dateien packen. Single responsibility prinzip
	   var select = 1;
	   
	
		
		//
		var songs = ["Cat.wav","bird.wav","wind.wav"];
 
       
        



	  //------------Audio Select
		
	 
			function selectSong(value) {		
					if (value == 0) {
					select = 0;}
					else if (value == 1) {
					select = 1;}
					else {
					select = 2;}

				
			}
   
   //------------Play Button
		var onOff = 0;
		
			function playOrPauseSong() {
				
				
				
				if (onOff == 0) {
					audioElement2.src = songs[select];
				
					audioPlayer.play(sound1, true)
				
					//Pic change
					document.getElementById("btn").src="pause.png";
					onOff = 1;
				}
				else {
					
					audioPlayer.stop(sound1)    			  
					//Pic change
					document.getElementById("btn").src="play.png";
					onOff = 0;
				}
			}

			
		

    </script>
	 
	   
		 
	
	</head>
	<!-- Page Elements	-->
		<body>
		
		<!-- Noisemaker	-->
		<div>
		<div>
				<input class="Noisemaker" id="s0" onclick="selectSong(0)" type="button"></button> 
		</div>
		 <div>
				<input class="Noisemaker" id="s1"  onclick="selectSong(1)" type="button"></button> 
		</div>
		<div>
				<input class="Noisemaker" id="s2" onclick="selectSong(2)" type="button"></button> 
		</div>
		 </div>
		 
		 
		 
		  <!-- Playbutton	-->
		 <button id="btn" type="button" onclick="playOrPauseSong()"  class="btn"> </button> 
		 
		 
		 
	


		 

		 
		 
		 
		 <!-- Room for 3D Audio		-->
		 <div class= "room">
			<img src="volume.svg" id="sourceAIcon" hidden>  
			<img src="person.svg" id="listenerIcon" hidden>
				<canvas id="canvas"></canvas>
		
				<script src="audio3d.js"></script>
				 <script src="https://cdn.jsdelivr.net/npm/resonance-audio/build/resonance-audio.min.js"></script>		<!-- google resonance audio sdk	-->
				<script src="canvasControl.js"></script>
		 </div>	
		 
		 
		 <h1> Equalizer </h1>
		 
			
		 
		
		 

		<!-- Equalizer	-->
		 <div class="Equalizer">
		 
			 
			 <div> Volume
                <input type="range" id="volumeslider" class="slider" min="0" max="100" value="10">
				 <span id="volumeOutput" class="output">0 dB</span>
            </div>
			<div> Gain
                <input type="range" id="gainslider" class="slider" min="-50" max="50" value="0">
				 <span id="gainOutput" class="output">0 dB</span>
            </div>
			<div> Bass
                <input type="range" id="bassslider" class="slider" min="0" max="100" value="0">
				 <span id="bassOutput" class="output">0 ?</span>
            </div>
			<div> Middle
                <input type="range" id="middleslider" class="slider" min="0" max="100" value="0">
				 <span id="middleOutput" class="output">0 ?</span>
            </div>
			<div> Treble
                <input type="range" id="trebleslider" class="slider" min="0" max="100" value="0">
				 <span id="trebleOutput" class="output">0 ?</span>
            </div>
			<div> Seek
                <input type="range" id="seekslider" class="slider" min="0" max="100" value="0">
				 <span id="reverbOutput" class="output">0 ?</span>
            </div>
			Reverb?
		 </div>
			
		<script>
		var seekslider, volumeslider, seeking=false, seekto;
	
	
		volumeslider = document.getElementById("volumeslider");
		volumeslider.addEventListener("mousemove", setvolume);
		seekslider = document.getElementById("seekslider");
		seekslider.addEventListener("mousedown", function(event){ seeking=true; seek(event); });
		seekslider.addEventListener("mousemove", function(event){ seek(event); });
		seekslider.addEventListener("mouseup",function(){ seeking=false; });

			
		function seek(event){
			if(seeking){
				seekslider.value = event.clientX - seekslider.offsetLeft;
				seekto = audioElement2.duration * (seekslider.value / 100);
				audioElement2.currentTime = seekto;
			}
		}
		function setvolume(){
			audioElement2.volume = volumeslider.value / 100;
		}


		
		</script>
		 


		 
		 
		</body>
		
		
</html>